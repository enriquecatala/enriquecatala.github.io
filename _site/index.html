<!DOCTYPE html>
<html class="no-js">
  <head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Language" content="en" />
	<title> Data engineering with Enrique Catalá</title>
	<!--<tittle>Enrique Catalá bañuls trololol</tittle>-->
	<meta name="description" content="Blog de Enrique Catalá, Microsoft Data Platform MVP, Ingeniero Informático centrado en Ingeniería de datos con Enrique Catalá Bañuls.">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-Frame-Options" content="sameorigin">

	<!-- CSS -->
	<link rel="stylesheet" href="/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="http://0.0.0.0:4000/">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Data engineering with Enrique Catalá" href="http://0.0.0.0:4000/feed.xml" />

	<!-- Font Awesome -->
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet" type="text/css">
	

	<!-- KaTeX -->
	
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min.css">
	<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min.js"></script>
	

	<!-- Google Analytics -->
	
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-169893411-1', 'auto');
	ga('send', 'pageview');
	</script>
	

	<!-- site tags -->
	
		





	
	
</head>

  <body>
    <header class="site-header">
	<div class="branding">
		
		<a href="/">
			<img class="avatar" src="/img/enrique.jpg" alt=""/>
		</a>
		
		<div class="site-title">
			<a href="/">Data engineering with Enrique Catalá</a>
		</div>
	</div>
	<nav class="site-nav">
		<ul>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<li>
				<a class="page-link" href="/about/">
					About
				</a>
			</li>
			
			
			
			
			
			
			
			
			
			<li>
				<a class="page-link" href="/search/">
					Search
				</a>
			</li>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<!-- Social icons from Font Awesome, if enabled -->
			


<li>
	<a href="mailto:enrique@enriquecatala.com" title="Email">
		<i class="fa fa-fw fa-envelope"></i>
	</a>
</li>













<li>
	<a href="https://github.com/enriquecatala" title="Follow on GitHub">
		<i class="fa fa-fw fa-github"></i>
	</a>
</li>







<li>
	<a href="https://www.linkedin.com/in/enriquecatala/" title="Follow on LinkedIn">
		<i class="fa fa-fw fa-linkedin"></i>
	</a>
</li>















<li>
	<a href="https://twitter.com/enriquecatala" title="Follow on Twitter">
		<i class="fa fa-fw fa-twitter"></i>
	</a>
</li>





<li>
	<a href="https://www.youtube.com/user/enriquecatala" title="Follow on YouTube">
		<i class="fa fa-fw fa-youtube"></i>
	</a>
</li>


		</ul>
	</nav>
</header>

    <div class="content">
      

<div class="home">
  
  <div class="call-out" 
  style="background-image: url('/')">
    <h1>Data engineering with Enrique Catalá</h1>

  </div>
  

  <div class="work">
    <h2>My Work</h2>
    <div>
      <ul>
    
        <li>
          <div>
            <a href="/portfolio/Badges.html"><img src="/img/icons/microsoft-certified-associate-badge-75x75.png" alt="Badges" title="Badges"/></a>
            <!--
              </p>
            <a href="/portfolio/Badges.html">Badges</a>
            -->
            <!--<p>Exam badges earned</p>-->
            <!--</p>-->
          </div>  
        </li>
    
        <li>
          <div>
            <a href="/portfolio/My%20youtube%20channel.html"><img src="/img/icons/youtube-75x75.png" alt="My YouTube channel" title="My YouTube channel"/></a>
            <!--
              </p>
            <a href="/portfolio/My%20youtube%20channel.html">My YouTube channel</a>
            -->
            <!--<p>My youtube data engineering focused channel</p>-->
            <!--</p>-->
          </div>  
        </li>
    
        <li>
          <div>
            <a href="/portfolio/SlideShare.html"><img src="/img/icons/slideshare.png" alt="My slides" title="My slides"/></a>
            <!--
              </p>
            <a href="/portfolio/SlideShare.html">My slides</a>
            -->
            <!--<p>PPTs, backups, pdfs...</p>-->
            <!--</p>-->
          </div>  
        </li>
    
        <li>
          <div>
            <a href="/portfolio/conferencias-publicas.html"><img src="/img/icons/teaching-75x75.png" alt="Videos de algunas de mis conferencias públicas" title="Videos de algunas de mis conferencias públicas"/></a>
            <!--
              </p>
            <a href="/portfolio/conferencias-publicas.html">Videos de algunas de mis conferencias públicas</a>
            -->
            <!--<p>Conferencias públicas</p>-->
            <!--</p>-->
          </div>  
        </li>
    
        <li>
          <div>
            <a href="/portfolio/github.html"><img src="/img/icons/github.png" alt="GitHub account" title="GitHub account"/></a>
            <!--
              </p>
            <a href="/portfolio/github.html">GitHub account</a>
            -->
            <!--<p>GitHub repos</p>-->
            <!--</p>-->
          </div>  
        </li>
    
        <li>
          <div>
            <a href="/portfolio/mssql-server-samplesdb.html"><img src="/img/icons/sqlserver-75x75.png" alt="SQL Server samplesdb docker image" title="SQL Server samplesdb docker image"/></a>
            <!--
              </p>
            <a href="/portfolio/mssql-server-samplesdb.html">SQL Server samplesdb docker image</a>
            -->
            <!--<p>SQL Server docker image with all sample databases</p>-->
            <!--</p>-->
          </div>  
        </li>
    
        <li>
          <div>
            <a href="/portfolio/sharedmaterial.html"><img src="/img/icons/microsoftonedrive.png" alt="Shared materials" title="Shared materials"/></a>
            <!--
              </p>
            <a href="/portfolio/sharedmaterial.html">Shared materials</a>
            -->
            <!--<p>PPTs, backups, pdfs...</p>-->
            <!--</p>-->
          </div>  
        </li>
    
      </ul> 
    </div>
  </div>

 
  <div class="posts">
    <h2>My Posts</h2>

    <div class="tags">
      <span>
         
          
           

          
          
          [<a href="/tag/AI">AI(6)</a>]

           

          
          
          [<a href="/tag/Azure">Azure(8)</a>]

           

          
          
          [<a href="/tag/Blocking">Blocking(1)</a>]

           

          
          
          [<a href="/tag/Blog">Blog(5)</a>]

           

          
          
          [<a href="/tag/BugFix">BugFix(2)</a>]

           

          
          
          [<a href="/tag/Cloud">Cloud(7)</a>]

           

          
          
          [<a href="/tag/Data">Data(1)</a>]

           

          
          
          [<a href="/tag/DataPlatform">DataPlatform(7)</a>]

           

          
          
          [<a href="/tag/Dev">Dev(8)</a>]

           

          
          
          [<a href="/tag/Docker">Docker(14)</a>]

           

          
          
          [<a href="/tag/Exam">Exam(2)</a>]

           

          
          
          [<a href="/tag/GitHub">GitHub(6)</a>]

           

          
          
          [<a href="/tag/Kubernetes">Kubernetes(17)</a>]

           

          
          
          [<a href="/tag/MVP">MVP(1)</a>]

           

          
          
          [<a href="/tag/OS">OS(6)</a>]

           

          
          
          [<a href="/tag/Performance">Performance(2)</a>]

           

          
          
          [<a href="/tag/PowerBI">PowerBI(2)</a>]

           

          
          
          [<a href="/tag/Python">Python(2)</a>]

           

          
          
          [<a href="/tag/Speaker">Speaker(8)</a>]

           

          
          
          [<a href="/tag/SqlServer">SqlServer(9)</a>]

           

          
          
          [<a href="/tag/TSQL">TSQL(1)</a>]

           

          
          
          [<a href="/tag/WSL2">WSL2(8)</a>]

           

          
          
          [<a href="/tag/YouTube">YouTube(5)</a>]

          
 
      </span>
    </div>

    
    <div class="post-teaser">
      <header>
        <h3>
          <a class="post-link" href="/2021/09/15/RuntimeError-already-borrowed.html">
            RuntimeError: Already borrowed
          </a>
        </h3>
        <p class="meta">
          September 15, 2021
        </p>
      </header>
      <div class="excerpt">
        <p>There was a nasty bug in <a href="https://huggingface.co/">huggingface’s</a> <a href="https://github.com/huggingface/tokenizers">tokenizers</a> that caused a random runtime error depending on how you deal with the tokenizer when processing your neural network in a <strong>multi-threading</strong> environment. Since I´m using kubernetes I was able to fix it by allowing the pod to be scheduled again, so I didn´t paid too much attention to it because it was related to the library itself and it was not my code the one that caused the bug.</p>

<blockquote>
  <p>NOTE: Details <a href="https://github.com/huggingface/tokenizers/issues/537">here</a></p>
</blockquote>

<p>But then, while checking my <a href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview">AppInsights</a> I found something very bad :). I found that the bug that I thought was occurring “<em>sometimes</em>” was happening <strong>all the time</strong>:</p>

<p>This is the error rate of my backend with the <a href="https://pypi.org/project/transformers/">transformers</a> version 4.6.0:</p>

<p><img src="/img/posts/runtimeerror-already-borrowed/buggy.png" alt="x" /></p>


        <a class="button" href="/2021/09/15/RuntimeError-already-borrowed.html">
          Continue reading
        </a>
      </div>
    </div>
    
    <div class="post-teaser">
      <header>
        <h3>
          <a class="post-link" href="/2021/09/09/install-specific-version-az-cli.html">
            How to use a specific version of az cli
          </a>
        </h3>
        <p class="meta">
          September 9, 2021
        </p>
      </header>
      <div class="excerpt">
        <p>There are some times when the latest version of az cli is not working. Like for example today while I was trying to debug a container issue running in Azure Container Instances.</p>

<p>I´m getting the following error while trying to connect and check why my container is not working:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~#@❯ az container logs <span class="nt">--resource-group</span> <span class="s2">"InteligenciaAlertasSentinel"</span> <span class="nt">--name</span> detector
The <span class="nb">command </span>failed with an unexpected error. Here is the traceback:
<span class="s1">'ContainerInstanceManagementClient'</span> object has no attribute <span class="s1">'container'</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"/opt/az/lib/python3.6/site-packages/knack/cli.py"</span>, line 231, <span class="k">in </span>invoke
    cmd_result <span class="o">=</span> self.invocation.execute<span class="o">(</span>args<span class="o">)</span>
  File <span class="s2">"/opt/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py"</span>, line 657, <span class="k">in </span>execute
    raise ex
  File <span class="s2">"/opt/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py"</span>, line 720, <span class="k">in </span>_run_jobs_serially
    results.append<span class="o">(</span>self._run_job<span class="o">(</span>expanded_arg, cmd_copy<span class="o">))</span>
  File <span class="s2">"/opt/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py"</span>, line 691, <span class="k">in </span>_run_job
    result <span class="o">=</span> cmd_copy<span class="o">(</span>params<span class="o">)</span>
  File <span class="s2">"/opt/az/lib/python3.6/site-packages/azure/cli/core/commands/__init__.py"</span>, line 328, <span class="k">in </span>__call__
    <span class="k">return </span>self.handler<span class="o">(</span><span class="k">*</span>args, <span class="k">**</span>kwargs<span class="o">)</span>
  File <span class="s2">"/opt/az/lib/python3.6/site-packages/azure/cli/core/commands/command_operation.py"</span>, line 112, <span class="k">in </span>handler
    client <span class="o">=</span> self.client_factory<span class="o">(</span>self.cli_ctx, command_args<span class="o">)</span> <span class="k">if </span>self.client_factory <span class="k">else </span>None
  File <span class="s2">"/opt/az/lib/python3.6/site-packages/azure/cli/command_modules/container/_client_factory.py"</span>, line 18, <span class="k">in </span>cf_container
    <span class="k">return </span>_container_instance_client_factory<span class="o">(</span>cli_ctx<span class="o">)</span>.container
AttributeError: <span class="s1">'ContainerInstanceManagementClient'</span> object has no attribute <span class="s1">'container'</span>
To open an issue, please run: <span class="s1">'az feedback'</span>
</code></pre></div></div>

<p>It seems the problem is <a href="https://github.com/Azure/azure-cli/issues/19475">related to the version of az cli</a> that I´m using (the last one while typing this post).</p>

<p>For situations like this, i recommend you to use the <a href="https://hub.docker.com/_/microsoft-azure-cli">official docker repo of azure az cli</a> which easily allows me to use a <a href="https://mcrflowprodcentralus.data.mcr.microsoft.com/mcrprod/azure-cli?P1=1631287029&amp;P2=1&amp;P3=1&amp;P4=4G2Xm%2FZgSoKLX2W856%2Feoxty3El5gyBaY2xnTS2KpLQ%3D&amp;se=2021-09-10T15%3A17%3A09Z&amp;sig=TDg2ib8Q5JU5FkGlx%2B7YQTXVQCJyPB8jPV6kIPf%2FEcc%3D&amp;sp=r&amp;sr=b&amp;sv=2015-02-21">specific version of az cli</a>.</p>


        <a class="button" href="/2021/09/09/install-specific-version-az-cli.html">
          Continue reading
        </a>
      </div>
    </div>
    
    <div class="post-teaser">
      <header>
        <h3>
          <a class="post-link" href="/2021/08/31/Speaker-netCoreConf-2021.html">
            Speaker netCoreConf 2021
          </a>
        </h3>
        <p class="meta">
          August 31, 2021
        </p>
      </header>
      <div class="excerpt">
        <p>Tengo el placer y honor de ser ponente en el próximo evento <a href="https://netcoreconf.com/">#netCoreConf</a> que tendrá lugar en los dias 9 y 10 de Octubre 2021.</p>

<p>En mi sesión voy a hablar durante 55m de <strong>Deeplearning state-of-the-art aplicado</strong> donde veremos cómo podemos realizar transfer learning sobre un modelo transformer state of the art como RoBERTa para Named Entity Recognition con nuestro propio dataset, que acabaremos desplegando en kubernetes para poder hacer inferencia como nuestra propia API de AI con FastAPI. La idea es que os quedeis con una alternativa diferente de bajo coste aprovechando Azure VM y AKS para desplegar los modelos que vuestros cientificos de datos acaban dejando típicamente en un python notebook :)</p>

<blockquote>
  <p>Jugaremos con Spacy, huggingface, pytorch, python, FastAPI, AKS y terraform :)</p>
</blockquote>

<p><img src="/img/posts/speaker-codemotion-2021-2/card.jpg" alt="card" /></p>

        <a class="button" href="/2021/08/31/Speaker-netCoreConf-2021.html">
          Continue reading
        </a>
      </div>
    </div>
    
    <div class="post-teaser">
      <header>
        <h3>
          <a class="post-link" href="/2021/07/26/release-memory-consumed-by-vmmem.html">
            How to release memory consumed by vmmem WSL2
          </a>
        </h3>
        <p class="meta">
          July 26, 2021
        </p>
      </header>
      <div class="excerpt">
        <p>There is a bug in WSL2 that causes the memory consumption of the vmmem process to not to be released. Right now, the version of WSL2 and windows i´m using is Windows 10 19043.1110 (21H1) and it´s still present.</p>

<p>This is what you can see when the error happens:</p>

<p>1) You have your WSL2 images stopped:</p>

<p><img src="/img/posts/vmmem-taking-too-much-memory/vmmem2.png" alt="vmmem1" /></p>

<p>2) There is a lot of memory ussage from the vmmem process:</p>

<p><img src="/img/posts/vmmem-taking-too-much-memory/vmmem1.png" alt="vmmem1" /></p>


        <a class="button" href="/2021/07/26/release-memory-consumed-by-vmmem.html">
          Continue reading
        </a>
      </div>
    </div>
    
    <div class="post-teaser">
      <header>
        <h3>
          <a class="post-link" href="/2021/07/22/como-desplegar-redes-neuronales-kubernetes-hw-cuda.html">
            Cómo desplegar redes neuronales en kubernetes con hardware CUDA
          </a>
        </h3>
        <p class="meta">
          July 22, 2021
        </p>
      </header>
      <div class="excerpt">
        <p>Hace unos dias tuve el placer y honor de ser ponente en el evento <a href="https://community.cncf.io/events/details/cncf-kcd-spain-presents-kubernetes-community-days-spain/">Kubernetes Community Days Spain</a></p>

<p>Aqui te dejo el vídeo de mi sesión, espero que te guste:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/-MaFzqWaRyM?start=14" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>


        <a class="button" href="/2021/07/22/como-desplegar-redes-neuronales-kubernetes-hw-cuda.html">
          Continue reading
        </a>
      </div>
    </div>
    
  </div>
 

  
  <div class="pagination">
    
    
    <a href="/blog/page2" class="button" >
      Next
      <i class="fa fa-chevron-right"></i>
    </a>
    
  </div>
  
</div>

    </div>
    <script src="/js/main.js"></script>


<footer class="site-footer">
	<p class="text">Subscribe to my channel! <script src="https://apis.google.com/js/platform.js"></script><div class="g-ytsubscribe" data-channelid="UCYboHnN6tvFfHqPWZWY82AQ" data-layout="default" data-count="default"></div>   
</p>
</footer>



  </body>
</html>
